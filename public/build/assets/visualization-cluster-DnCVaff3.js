import{r as n,j as e}from"./app-BlV91FWz.js";import{s as w,K as k}from"./modelstorage-CgjoKV6F.js";import{K as M}from"./kmeansCalculator-eGQwbsaH.js";import{a as K,A as S,C as H}from"./ClusterVisualization-C0Gp4rvU.js";import{m as t}from"./proxy-DsGhCzcj.js";import{L as O}from"./loader-circle-BEi-q8Dl.js";import{C as T}from"./chart-column-COO1vGY_.js";import{C as A}from"./calculator-BofzJlUZ.js";import{T as E}from"./trending-up-m0mMhl2I.js";import"./createLucideIcon-x4OClAdX.js";import"./chevron-up-XG-zX58t.js";const q=({foodData:l})=>{const[R,g]=n.useState([]),[h,p]=n.useState({}),[b,d]=n.useState(!1),[r,y]=n.useState(null),j=["Pagi","Siang","Malam"],[f,v]=n.useState([]);n.useEffect(()=>{l.length>0&&u()},[l]);const u=async()=>{d(!0),setTimeout(async()=>{const a=new M,i=a.performKMeans(l,100,"RANDOM"),m=a.calculateClusterStats(i),c=i.map(s=>{var x;return{...s,clusterResult:j[((x=s.clusterResult)==null?void 0:x.cluster)||0]}});try{(await w(i,"kmeans_nutrition_model")).success&&console.log("Model saved successfully")}catch(s){console.error("Error during clustering calculation:",s)}v(c),g(i),p(m),d(!1)},100)},C={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1}}},o={hidden:{y:20,opacity:0},visible:{y:0,opacity:1,transition:{duration:.5,ease:"easeOut"}}},N={hidden:{scale:.9,opacity:0},visible:{scale:1,opacity:1,transition:{duration:.4,ease:"easeOut"}}};return b?e.jsxs(t.div,{initial:{opacity:0},animate:{opacity:1},className:"flex min-h-64 flex-col items-center justify-center rounded-2xl bg-gradient-to-br from-blue-50 to-blue-50 p-8",children:[e.jsx(t.div,{animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},className:"mb-4",children:e.jsx(O,{className:"h-12 w-12 text-blue-600"})}),e.jsx(t.h3,{initial:{y:10,opacity:0},animate:{y:0,opacity:1},className:"text-lg font-semibold text-gray-700",children:"Menghitung Clustering..."}),e.jsx(t.p,{initial:{y:10,opacity:0},animate:{y:0,opacity:1},transition:{delay:.2},className:"mt-2 text-sm text-gray-500",children:"Menganalisis pola nutrisi menggunakan algoritma K-Means"})]}):e.jsxs(t.div,{initial:"hidden",animate:"visible",variants:C,className:"space-y-8",children:[e.jsxs(t.div,{variants:o,className:"text-center",children:[e.jsx(t.div,{whileHover:{scale:1.05},className:"mb-4 inline-flex items-center justify-center rounded-2xl bg-gradient-to-r from-blue-600 to-blue-600 p-3",children:e.jsx(K,{className:"h-8 w-8 text-white"})}),e.jsx("h2",{className:"mb-2 text-3xl font-bold text-gray-900",children:"Hasil Clustering Makanan"}),e.jsx("p",{className:"mx-auto max-w-2xl text-gray-600",children:"Analisis pola nutrisi menggunakan algoritma K-Means untuk mengelompokkan makanan berdasarkan kandungan gizi"})]}),e.jsxs(t.div,{variants:o,children:[e.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[e.jsxs("h3",{className:"flex items-center text-xl font-semibold text-gray-900",children:[e.jsx(T,{className:"mr-2 h-6 w-6 text-blue-600"}),"Statistik Kluster"]}),e.jsxs(t.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:u,className:"rounded-lg bg-blue-600 px-4 py-2 text-sm font-medium text-white transition-colors hover:bg-blue-700",children:[e.jsx(A,{className:"mr-1 inline h-4 w-4"}),"Hitung Ulang"]})]}),e.jsx("div",{className:"mb-8 grid grid-cols-1 gap-6 md:grid-cols-2 lg:grid-cols-3",children:Object.entries(h).map(([a,i],m)=>e.jsxs(t.div,{variants:N,initial:"hidden",animate:"visible",transition:{delay:m*.1},className:`cursor-pointer rounded-2xl border-2 bg-white p-6 shadow-lg transition-all duration-300 hover:shadow-xl ${r===a?"border-blue-500 ring-4 ring-blue-100":"border-gray-100"}`,onClick:()=>y(r===a?null:a),whileHover:{y:-5},children:[e.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`mr-3 h-4 w-4 rounded-full ${a==="0"||a==="1"?"bg-blue-500":a==="2"?"bg-purple-500":"bg-orange-500"}`}),e.jsxs("h4",{className:"font-semibold text-gray-900",children:["Kluster ",a]})]}),e.jsxs("span",{className:"rounded-full bg-blue-100 px-3 py-1 text-sm font-medium text-blue-800",children:[i.count," makanan"]})]}),e.jsx(S,{children:r===a&&e.jsx(t.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"mt-4 space-y-3",children:Object.entries(i.averages).map(([c,s])=>e.jsxs(t.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},className:"flex items-center justify-between border-b border-gray-100 py-2 last:border-b-0",children:[e.jsx("span",{className:"text-sm font-medium text-gray-600 capitalize",children:c.replace(/_/g," ")}),e.jsx("span",{className:"text-sm font-bold text-blue-600",children:typeof s=="number"?s.toFixed(2):s})]},c))})}),r!==a&&e.jsxs(t.div,{initial:{opacity:0},animate:{opacity:1},className:"mt-4 flex items-center justify-center",children:[e.jsx(E,{className:"mr-2 h-4 w-4 text-gray-400"}),e.jsx("span",{className:"text-sm text-gray-500",children:"Klik untuk melihat detail"})]})]},a))})]}),e.jsx(t.div,{variants:o,children:e.jsx(H,{data:l})}),e.jsx(t.div,{variants:o,children:e.jsx(k,{data:f})})]})};export{q as default};
