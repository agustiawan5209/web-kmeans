import{a as k,r,j as e}from"./app-d-qLC2bI.js";import{K as M}from"./klusterFood-C6TAy_e9.js";import{K}from"./kmeansCalculator-BElIrl4b.js";import{a as S,C as E}from"./ClusterVisualization-PmNdBr2f.js";import{m as t}from"./proxy--f8wKCdQ.js";import{L as T}from"./loader-circle-VM8AHDZI.js";import{C as H}from"./chart-column-CU0hT-2t.js";import{C as _}from"./calculator-ClmrqqB9.js";import{A as O}from"./index-aiqTfpOA.js";import{T as V}from"./trending-up-DHOFrpqA.js";import"./createLucideIcon-CxW8n3fz.js";import"./chevron-up-DBcuK_yb.js";async function z(l,d){try{const i={model_name:d,model_json:l};console.log(i);const x=await k.post(route("model.store"),i,{headers:{"Content-Type":"application/json"}});return{success:!0,message:"Model saved successfully"}}catch(i){return console.error("Error saving model:",i),{success:!1,message:i instanceof Error?i.message:"Unknown error occurred"}}}const J=({foodData:l})=>{const[d,i]=r.useState([]),[x,y]=r.useState({}),[b,p]=r.useState(!1),[o,f]=r.useState(null),j=["Pagi","Siang","Malam"],[v,C]=r.useState([]);r.useEffect(()=>{l.length>0&&g()},[l]);const g=async()=>{p(!0),setTimeout(async()=>{const s=new K,n=s.performKMeans(l),u=s.calculateClusterStats(n),m=n.map(a=>{var h;return{...a,clusterResult:j[((h=a.clusterResult)==null?void 0:h.cluster)||0]}});try{(await z(n,"kmeans_nutrition_model")).success&&console.log("Model saved successfully")}catch(a){console.error("Error during clustering calculation:",a)}C(m),i(n),y(u),p(!1)},100)},w={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1}}},c={hidden:{y:20,opacity:0},visible:{y:0,opacity:1,transition:{duration:.5,ease:"easeOut"}}},N={hidden:{scale:.9,opacity:0},visible:{scale:1,opacity:1,transition:{duration:.4,ease:"easeOut"}}};return b?e.jsxs(t.div,{initial:{opacity:0},animate:{opacity:1},className:"flex min-h-64 flex-col items-center justify-center rounded-2xl bg-gradient-to-br from-blue-50 to-blue-50 p-8",children:[e.jsx(t.div,{animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},className:"mb-4",children:e.jsx(T,{className:"h-12 w-12 text-blue-600"})}),e.jsx(t.h3,{initial:{y:10,opacity:0},animate:{y:0,opacity:1},className:"text-lg font-semibold text-gray-700",children:"Menghitung Clustering..."}),e.jsx(t.p,{initial:{y:10,opacity:0},animate:{y:0,opacity:1},transition:{delay:.2},className:"mt-2 text-sm text-gray-500",children:"Menganalisis pola nutrisi menggunakan algoritma K-Means"})]}):e.jsxs(t.div,{initial:"hidden",animate:"visible",variants:w,className:"space-y-8",children:[e.jsxs(t.div,{variants:c,className:"text-center",children:[e.jsx(t.div,{whileHover:{scale:1.05},className:"mb-4 inline-flex items-center justify-center rounded-2xl bg-gradient-to-r from-blue-600 to-blue-600 p-3",children:e.jsx(S,{className:"h-8 w-8 text-white"})}),e.jsx("h2",{className:"mb-2 text-3xl font-bold text-gray-900",children:"Hasil Clustering Makanan"}),e.jsx("p",{className:"mx-auto max-w-2xl text-gray-600",children:"Analisis pola nutrisi menggunakan algoritma K-Means untuk mengelompokkan makanan berdasarkan kandungan gizi"})]}),e.jsxs(t.div,{variants:c,children:[e.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[e.jsxs("h3",{className:"flex items-center text-xl font-semibold text-gray-900",children:[e.jsx(H,{className:"mr-2 h-6 w-6 text-blue-600"}),"Statistik Kluster"]}),e.jsxs(t.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:g,className:"rounded-lg bg-blue-600 px-4 py-2 text-sm font-medium text-white transition-colors hover:bg-blue-700",children:[e.jsx(_,{className:"mr-1 inline h-4 w-4"}),"Hitung Ulang"]})]}),e.jsx("div",{className:"mb-8 grid grid-cols-1 gap-6 md:grid-cols-2 lg:grid-cols-3",children:Object.entries(x).map(([s,n],u)=>e.jsxs(t.div,{variants:N,initial:"hidden",animate:"visible",transition:{delay:u*.1},className:`cursor-pointer rounded-2xl border-2 bg-white p-6 shadow-lg transition-all duration-300 hover:shadow-xl ${o===s?"border-blue-500 ring-4 ring-blue-100":"border-gray-100"}`,onClick:()=>f(o===s?null:s),whileHover:{y:-5},children:[e.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`mr-3 h-4 w-4 rounded-full ${s==="0"||s==="1"?"bg-blue-500":s==="2"?"bg-purple-500":"bg-orange-500"}`}),e.jsxs("h4",{className:"font-semibold text-gray-900",children:["Kluster ",s]})]}),e.jsxs("span",{className:"rounded-full bg-blue-100 px-3 py-1 text-sm font-medium text-blue-800",children:[n.count," makanan"]})]}),e.jsx(O,{children:o===s&&e.jsx(t.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"mt-4 space-y-3",children:Object.entries(n.averages).map(([m,a])=>e.jsxs(t.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},className:"flex items-center justify-between border-b border-gray-100 py-2 last:border-b-0",children:[e.jsx("span",{className:"text-sm font-medium text-gray-600 capitalize",children:m.replace(/_/g," ")}),e.jsx("span",{className:"text-sm font-bold text-blue-600",children:typeof a=="number"?a.toFixed(2):a})]},m))})}),o!==s&&e.jsxs(t.div,{initial:{opacity:0},animate:{opacity:1},className:"mt-4 flex items-center justify-center",children:[e.jsx(V,{className:"mr-2 h-4 w-4 text-gray-400"}),e.jsx("span",{className:"text-sm text-gray-500",children:"Klik untuk melihat detail"})]})]},s))})]}),e.jsx(t.div,{variants:c,children:e.jsx(E,{data:d})}),e.jsx(t.div,{variants:c,children:e.jsx(M,{data:v})})]})};export{J as default};
